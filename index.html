<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>阿拉伯语词卡学习网站</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f0f4f8;
      margin: 0;
      padding: 2rem;
      text-align: center;
    }
    .card {
      background: white;
      border-radius: 16px;
      padding: 2rem;
      max-width: 600px;
      margin: auto;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    .word { font-size: 2.5rem; color: #1a73e8; margin-bottom: 0.5rem; }
    .pinyin { font-size: 1.2rem; color: #444; }
    .translation, .example {
      margin-top: 1rem;
      font-size: 1.1rem;
    }
    button {
      margin-top: 2rem;
      padding: 0.75rem 2rem;
      font-size: 1rem;
      border: none;
      border-radius: 8px;
      background-color: #1a73e8;
      color: white;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div class="card">
    <div class="word" id="arabicWord">加载中...</div>
    <div class="pinyin" id="pinyin">拼音加载中...</div>
    <div class="translation" id="translations">翻译加载中...</div>
    <div class="example" id="example">例句加载中...</div>
    <audio id="audio" controls style="margin-top:1rem;"></audio>
    <button onclick="loadNextCard()">下一条</button>
  </div>

  <script>
    const GEMINI_API_KEY = 'YOUR_GEMINI_API_KEY'; // 🔒 请将此放到中转服务中，前端勿暴露

    async function fetchFromGemini(prompt) {
      const response = await fetch("https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=" + GEMINI_API_KEY, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          contents: [{
            parts: [{ text: prompt }]
          }]
        })
      });
      const data = await response.json();
      return data.candidates?.[0]?.content?.parts?.[0]?.text || "内容生成失败";
    }

    async function loadNextCard() {
      const wordList = ['لفائف', 'حديد', 'زنك', 'مجلفن', 'طلاء']; // 示例阿语词汇，可从远程加载
      const randomWord = wordList[Math.floor(Math.random() * wordList.length)];

      const prompt = `请用学习者视角帮我解释这个阿拉伯语词：${randomWord}，输出JSON结构，内容包括：\n1. 中文翻译\n2. 英文翻译\n3. 阿语拼音（拼音风格接近汉语）\n4. 阿语例句 + 中文翻译\n5. 通俗记忆口诀`;      

      const result = await fetchFromGemini(prompt);

      try {
        const parsed = JSON.parse(result);
        document.getElementById("arabicWord").innerText = randomWord;
        document.getElementById("pinyin").innerText = parsed["阿语拼音"];
        document.getElementById("translations").innerText = `中文: ${parsed["中文翻译"]} | 英文: ${parsed["英文翻译"]}`;
        document.getElementById("example").innerText = `例句: ${parsed["阿语例句"]}\n${parsed["中文翻译例句"]}`;

        const audioUrl = `https://translate.google.com/translate_tts?ie=UTF-8&q=${encodeURIComponent(randomWord)}&tl=ar&client=tw-ob`;
        document.getElementById("audio").src = audioUrl;

      } catch (e) {
        document.getElementById("arabicWord").innerText = "解析错误";
        document.getElementById("translations").innerText = result;
        console.error("解析失败：", e, result);
      }
    }

    window.onload = loadNextCard;
  </script>
</body>
</html>
